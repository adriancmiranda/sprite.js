// sprite.js@v0.0.1, MIT licensed. https://github.com/adriancmiranda/sprite.js
!function(t,e,n){"use strict";function o(t,e){if(t===!1)return"Boolean";if(""===t)return"String";if(0===t)return"Number";if(t&&t.constructor){var n=(t.constructor.toString()||Object.prototype.toString.apply(t)).replace(/^.*function([^\s]*|[^\(]*)\([^\x00]+$/,"$1").replace(/^(\[object\s)|]$/g,"").replace(/\s+/,"")||"Object";return e===!0||/^(Boolean|RegExp|Number|String|Array|Date)$/.test(n)?n:"Object"}return t}function r(e,n){var r=typeof e;return e===!1?"boolean":""===e?"string":(e&&"object"===r&&(r=o(e,n),r=String(r).toLowerCase()),"number"===r&&!t.isNaN(e)&&t.isFinite(e)?n===!0&&t.parseFloat(e)===t.parseInt(e,10)?0>e?"int":"uint":"number":e?r:e)}function a(e,n){return e=t.parseFloat(e),e=t.isNaN(e)||!t.isFinite(e)?0:e,n===!0&&(e=t.parseInt(1e4*e,10)/1e4),e}function i(t){return"string"===r(t)?/^(true|(^[1-9][0-9]*$)$|yes|y|sim|s|on)$/gi.test(t):!!t}function u(e){return 0|t.parseInt(e,10)}function m(t){return t=u(t),0>t?0:t}function l(t,e,n){return r(t)?r(n)?void t.setAttribute("data-"+e,n):t.getAttribute("data-"+e):null}function s(t,e,n){var o,a={};e="object"===r(e)?e:{};for(o in t){var i=l(n,o);a[o]=e.hasOwnProperty(o)||i?e[o]||i:t[o]}return a}function c(t,e,n,o,r,a,i){var u,m,l,s,c,p=[];for(u=0;t>u;u++)l=i?~~(u/e):u%e,m=i?u%e:~~(u/e),s=Math.round(n+r)*l,c=Math.round(o+a)*m,p.push({column:l,row:m,x:0-s,y:0-c,frame:u,label:""});return p}function p(e,n){return t.getComputedStyle?t.getComputedStyle(e,null)[n]:e.currentStyle[n]}function f(t){var e=(p(t,"backgroundPosition")||p(t,"backgroundPositionX")+" "+p(t,"backgroundPositionY")).replace(/left|top/gi,0).split(" ");return{x:u(e[0]),y:u(e[1])}}function g(t){var e=p(t,"backgroundImage")||"";return e.replace(/url\(|\)|"|'/g,"")}function F(t,e,n){return t=a(t),e=a(e),n=a(n),t>n?n:e>t?e:t}function y(t,e,n){return t=a(t),e=a(e),n=a(n),t%=n,a(e>t?t+n:t)}!function(){var e,n,o,r,a,i;for(n=0,o=["ms","moz","webkit","o"],e=0;e<o.length&&!t.requestAnimationFrame;++e)r=o[e]+"RequestAnimationFrame",a=o[e]+"CancelAnimationFrame",i=o[e]+"CancelRequestAnimationFrame",t.requestAnimationFrame=t[r],t.cancelAnimationFrame=t[a]||t[i];t.requestAnimationFrame||(t.requestAnimationFrame=function(e,o){var r,a,i;return r=(new Date).getTime(),a=Math.max(0,16-(r-n)),i=t.setTimeout(function(){e(r+a,o)},a),n=r+a,i}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(e){t.clearTimeout(e)})}(),n.Utils=n.Utils||{},n.Utils.getDefinitionName=o,n.Utils.typeOf=r,n.Utils.num=a,n.Utils.bool=i,n.Utils.int=u,n.Utils.uint=m,n.Utils.data=l,n.Utils.merge=s,n.Utils.gridLayout=c,n.Utils.getStyle=p,n.Utils.getBackgroundOffsetFrom=f,n.Utils.getBackgroundImageFrom=g,n.Utils.bound=F,n.Utils.mod=y,n.Sprite=function(e,n){function o(e){l(),x=t.setTimeout(function(){P=p(A,S.element,S.fps),"function"==typeof T.onStart&&T.onStart.apply(S,T.onStartParams),S.running=!0},e)}function l(){t.clearTimeout(x),S.running=!1,x=0}function p(e,n,o){var a,i;if("function"===r(e))return"number"===r(n)&&(o=n,n=null),i=++h.animationID,o=1e3/F(o||10,1,60),h.animations[i]={timeout:0,rAF:0},a=Array.prototype.slice.call(arguments,0),a.splice(0,3),function u(){h.animations[i].timeout=t.setTimeout(function(){h.animations[i].rAF=t.requestAnimationFrame(u,n),e.apply(null,a)},o)}(),i}function d(e){r(h.animations[e])&&(t.clearTimeout(h.animations[e].timeout),t.cancelAnimationFrame(h.animations[e].rAF),delete h.animations[e])}function b(t){S.lastFrame=S.currentFrame,S.currentFrame=y(m(t),1,S.totalFrames),S.row=S.timeline[S.currentFrame-1].row,S.column=S.timeline[S.currentFrame-1].column,S.offsetX=S.timeline[S.currentFrame-1].x+S.image.x,S.offsetY=S.timeline[S.currentFrame-1].y+S.image.y,S.element.style.backgroundPosition=S.offsetX+"px "+S.offsetY+"px"}function A(){"function"==typeof T.onUpdate&&T.onUpdate.apply(S,T.onUpdateParams),S.currentFrame<S.targetFrame?b(S.currentFrame+j):S.currentFrame>S.targetFrame?b(S.currentFrame+j):S.currentFrame===S.targetFrame&&(S.looping?S.yoyo?S.loopBetween(S.currentFrame,S.targetNextFrame,S.yoyo,T):S.loopBetween(S.targetNextFrame,S.currentFrame,S.yoyo,T):(S.pause(),"function"==typeof T.onComplete&&T.onComplete.apply(S,T.onCompleteParams)))}var S=this,h=S.constructor.static,v=f(e),w=g(e),U=0,x=0,j=1,P=null,T={};S.id=h.instances++,S.element=e,S.image={url:w,object:new Image,x:v.x,y:v.y},S.options=s(h.defaults,n,S.element),S.fps=a(S.options.fps),S.totalFrames=Math.max(1,m(S.options.totalFrames)),S.columns=m(S.options.columns),S.rows=m(S.options.rows),1===S.totalFrames&&(S.totalFrames=S.columns*S.rows),S.currentFrame=F(S.options.currentFrame,1,S.totalFrames),S.vertical=i(S.options.vertical),S.tileW=a(S.options.tileW)||S.element.clientWidth,S.tileH=a(S.options.tileH)||S.element.clientHeight,S.column=a(S.currentFrame%S.rows),S.row=~~(S.currentFrame/S.columns),S.timeline=c(S.totalFrames,S.vertical?S.rows:S.columns,S.tileW,S.tileH,0,0,S.vertical),S.duration=S.totalFrames/S.fps,S.lastFrame=S.currentFrame,S.targetNextFrame=0,S.targetFrame=0,S.offsetX=v.x,S.offsetY=v.y,S.reverse=!1,S.running=!1,S.looping=!1,S.yoyo=!1,S.load=function(t){t="object"===r(t)?t:{},S.image.object.src=S.image.url,S.image.object.onload=function(){S.image.width=S.image.object.width,S.image.height=S.image.object.height,"function"==typeof t.onLoad&&t.onLoad.apply(S,t.onLoadParams)}},S.play=function(t,e){S.pause(),"uint"===r(t,!0)?(T="object"===r(e)?e:{},S.targetFrame=F(t,1,S.totalFrames),S.reverse=S.currentFrame>S.targetFrame,j=S.reverse?-1:1):S.targetFrame=0,"function"==typeof T.onInit&&T.onInit.apply(S,T.onInitParams),o(a(T.delay))},S.pause=function(){l(),d(P),P=null},S.togglePause=function(){S[P?"pause":"play"]()},S.stop=function(){l(),b(0),S.pause()},S.playToBeginAndStop=function(t){S.play(0,t)},S.playToEndAndStop=function(t){S.play(S.totalFrames,t)},S.gotoRandomFrame=function(){S.gotoAndStop(~~(Math.random()*S.totalFrames)+1)},S.fromTo=function(e,n,o){o="object"===r(o)?o:{},t.clearTimeout(U),U=0,U=t.setTimeout(function(){delete o.delay,S.gotoAndStop(e),S.play(n,o)},a(o.delay))},S.gotoAndPlay=function(t){l(),b(t),S.play()},S.gotoAndStop=function(t){l(),b(t),S.pause()},S.nextFrame=function(){S.jumpFrames(1)},S.prevFrame=function(){S.jumpFrames(-1)},S.jumpFrames=function(t){S.gotoAndStop(S.currentFrame+u(t))},S.loopBetween=function(t,e,n,o){t=F(t,1,S.totalFrames),e=F(e,0,S.totalFrames),S.gotoAndStop(t),S.running=!0,S.looping=!0,S.yoyo=i(n),S.targetNextFrame=t,0===e&&(e=S.totalFrames),S.play(e,o)},S.cancelLooping=function(){S.running=!1,S.looping=!1,S.yoyo=!1},S.toString=function(){return"AM[Sprite "+S.id+"]"}},n.Sprite.static={instances:0,animationID:0,animations:{},defaults:{fps:24,totalFrames:1,currentFrame:1,vertical:!1,tileW:0,tileH:0,columns:0,rows:0}}}(this,this.document,this.AM=this.AM||{});